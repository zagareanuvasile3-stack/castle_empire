<!DOCTYPE html>

<html lang="ru">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Castle Empire</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>

        * {

            box-sizing: border-box;

            margin: 0;

            padding: 0;

            -webkit-tap-highlight-color: transparent;

        }

        

        body {

            background: linear-gradient(135deg, #0b2b40 0%, #093145 100%);

            color: white;

            font-family: 'Segoe UI', Roboto, sans-serif;

            padding: 15px;

            min-height: 100vh;

        }

        

        .container {

            max-width: 100%;

            margin: 0 auto;

        }

        

        /* –®–ê–ü–ö–ê */

        .header {

            text-align: center;

            margin-bottom: 20px;

            padding: 15px;

            background: rgba(25, 55, 75, 0.6);

            border-radius: 16px;

            border: 1px solid rgba(42, 150, 165, 0.3);

        }

        

        .game-title {

            font-size: 24px;

            font-weight: bold;

            color: #ff9d00;

            margin-bottom: 5px;

        }

        

        /* –†–ï–°–£–†–°–´ */

        .resources-grid {

            display: grid;

            grid-template-columns: repeat(2, 1fr);

            gap: 10px;

            margin-bottom: 20px;

        }

        

        .resource-card {

            background: linear-gradient(135deg, #15616b 0%, #093145 100%);

            padding: 12px;

            border-radius: 12px;

            display: flex;

            align-items: center;

            gap: 10px;

            box-shadow: 0 3px 10px rgba(0,0,0,0.2);

        }

        

        .resource-icon {

            width: 35px;

            height: 35px;

            border-radius: 50%;

            background: linear-gradient(135deg, #ff9d00 0%, #ff7800 100%);

            display: flex;

            align-items: center;

            justify-content: center;

            font-size: 18px;

        }

        

        .resource-info {

            flex: 1;

        }

        

        .resource-name {

            font-size: 12px;

            opacity: 0.8;

        }

        

        .resource-amount {

            font-weight: bold;

            font-size: 16px;

        }

        

        /* –ó–î–ê–ù–ò–Ø */

        .buildings-grid {

            display: grid;

            grid-template-columns: repeat(2, 1fr);

            gap: 15px;

            margin-bottom: 20px;

        }

        

        .building-card {

            background: linear-gradient(135deg, #1e5f75 0%, #164b60 100%);

            border-radius: 14px;

            padding: 18px 12px;

            text-align: center;

            border: 2px solid rgba(42, 150, 165, 0.3);

        }

        

        .building-icon {

            font-size: 36px;

            margin-bottom: 8px;

            display: block;

        }

        

        .building-name {

            font-weight: bold;

            font-size: 15px;

            margin-bottom: 5px;

        }

        

        .building-level {

            background: rgba(0,0,0,0.3);

            padding: 3px 10px;

            border-radius: 15px;

            font-size: 12px;

            display: inline-block;

            margin-bottom: 5px;

        }

        

        .building-production {

            font-size: 11px;

            opacity: 0.8;

        }

        

        /* –¢–ê–ô–ú–ï–† */

        .timer-status {

            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);

            color: white;

            padding: 12px;

            border-radius: 12px;

            text-align: center;

            margin-bottom: 10px;

            font-weight: bold;

        }

        

        .timer-status.ready {

            background: linear-gradient(135deg, #00b894 0%, #00a085 100%);

        }

        

        .collection-info {

            font-size: 12px;

            opacity: 0.8;

            text-align: center;

            margin-bottom: 15px;

        }

        

        /* –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô */

        .actions-bar {

            display: grid;

            grid-template-columns: repeat(2, 1fr);

            gap: 10px;

            margin-bottom: 15px;

        }

        

        .action-btn {

            background: linear-gradient(135deg, #ff9d00 0%, #ff7800 100%);

            color: #093145;

            border: none;

            padding: 14px 10px;

            border-radius: 12px;

            font-weight: bold;

            font-size: 14px;

            cursor: pointer;

            display: flex;

            flex-direction: column;

            align-items: center;

            gap: 4px;

            box-shadow: 0 3px 8px rgba(255, 157, 0, 0.3);

        }

        

        .action-btn:disabled {

            opacity: 0.6;

            cursor: not-allowed;

        }

        

        .action-btn:active:not(:disabled) {

            transform: scale(0.97);

        }

        

        .btn-icon {

            font-size: 20px;

        }

        

        /* –°–¢–ê–¢–£–° –ë–ê–† */

        .status-bar {

            background: rgba(25, 55, 75, 0.7);

            padding: 10px;

            border-radius: 10px;

            text-align: center;

            font-size: 13px;

            margin-top: 10px;

        }

    </style>

</head>

<body>

    <div class="container">

        <!-- –®–ê–ü–ö–ê -->

        <div class="header">

            <div class="game-title">üè∞ Castle Empire</div>

            <div>–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —Å–≤–æ–µ –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–æ!</div>

        </div>

        

        <!-- –†–ï–°–£–†–°–´ -->

        <div class="resources-grid">

            <div class="resource-card">

                <div class="resource-icon">üíé</div>

                <div class="resource-info">

                    <div class="resource-name">–ê–õ–ú–ê–ó–´</div>

                    <div class="resource-amount" id="gems-count">5.0</div>

                </div>

            </div>

            

            <div class="resource-card">

                <div class="resource-icon">üåæ</div>

                <div class="resource-info">

                    <div class="resource-name">–ï–î–ê</div>

                    <div class="resource-amount" id="food-count">120</div>

                </div>

            </div>

            

            <div class="resource-card">

                <div class="resource-icon">ü™µ</div>

                <div class="resource-info">

                    <div class="resource-name">–î–ï–†–ï–í–û</div>

                    <div class="resource-amount" id="wood-count">80</div>

                </div>

            </div>

            

            <div class="resource-card">

                <div class="resource-icon">‚õ∞Ô∏è</div>

                <div class="resource-info">

                    <div class="resource-name">–ö–ê–ú–ï–ù–¨</div>

                    <div class="resource-amount" id="stone-count">60</div>

                </div>

            </div>

        </div>

        

        <!-- –ó–î–ê–ù–ò–Ø -->

        <div class="buildings-grid">

            <div class="building-card" data-type="castle">

                <span class="building-icon">üè∞</span>

                <div class="building-name">–ó–ê–ú–û–ö</div>

                <div class="building-level">–£—Ä–æ–≤–µ–Ω—å 1</div>

                <div class="building-production">+0.1 –∞–ª–º–∞–∑–æ–≤/—á–∞—Å</div>

            </div>

            

            <div class="building-card" data-type="farm">

                <span class="building-icon">üåæ</span>

                <div class="building-name">–§–ï–†–ú–ê</div>

                <div class="building-level">–£—Ä–æ–≤–µ–Ω—å 1</div>

                <div class="building-production">+5 –µ–¥—ã/—á–∞—Å</div>

            </div>

            

            <div class="building-card" data-type="sawmill">

                <span class="building-icon">ü™µ</span>

                <div class="building-name">–õ–ï–°–û–ü–ò–õ–ö–ê</div>

                <div class="building-level">–£—Ä–æ–≤–µ–Ω—å 1</div>

                <div class="building-production">+3 –¥–µ—Ä–µ–≤–∞/—á–∞—Å</div>

            </div>

            

            <div class="building-card" data-type="mine">

                <span class="building-icon">‚õèÔ∏è</span>

                <div class="building-name">–®–ê–•–¢–ê</div>

                <div class="building-level">–£—Ä–æ–≤–µ–Ω—å 1</div>

                <div class="building-production">+2 –∫–∞–º–Ω—è/—á–∞—Å</div>

            </div>

        </div>

        

        <!-- –¢–ê–ô–ú–ï–† -->

        <div class="timer-status" id="timerStatus">

            ‚è≥ –î–æ —Å–±–æ—Ä–∞: <span id="timer">12:00:00</span>

        </div>

        

        <div class="collection-info">

            üí° –ú–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–∞–∂–¥—ã–µ 12 —á–∞—Å–æ–≤

        </div>

        

        <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô -->

        <div class="actions-bar">

            <button class="action-btn" id="collectBtn" onclick="collectResources()">

                <span class="btn-icon">üéÅ</span>

                <span>–°–û–ë–†–ê–¢–¨</span>

            </button>

            

            <button class="action-btn" onclick="inviteFriends()">

                <span class="btn-icon">üë•</span>

                <span>–ü–†–ò–ì–õ–ê–°–ò–¢–¨</span>

            </button>

            

            <button class="action-btn" onclick="upgradeBuilding()">

                <span class="btn-icon">‚ö°</span>

                <span>–£–õ–£–ß–®–ò–¢–¨</span>

            </button>

            

            <button class="action-btn" onclick="showStats()">

                <span class="btn-icon">üìä</span>

                <span>–°–¢–ê–¢–ò–°–¢–ò–ö–ê</span>

            </button>

        </div>

        

        <!-- –°–¢–ê–¢–£–° –ë–ê–† -->

        <div class="status-bar">

            üëë –ò–≥—Ä–æ–∫: <span id="player-name">–ë–∞–ª—Ç–∏–π</span> | üë• –†–µ—Ñ–µ—Ä–∞–ª–æ–≤: <span id="referrals-count">0</span>

        </div>

    </div>



    <script>

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp

        const tg = window.Telegram.WebApp;

        

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã

        const COLLECTION_COOLDOWN = 12 * 60 * 60 * 1000; // 12 —á–∞—Å–æ–≤

        let lastCollectionTime = Date.now() - 6 * 60 * 60 * 1000; // 6 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥

        let resources = {

            gems: 5.0,

            food: 120,

            wood: 80,

            stone: 60

        };

        

        let buildings = {

            castle: { level: 1, production: 0.1 },

            farm: { level: 1, production: 5 },

            sawmill: { level: 1, production: 3 },

            mine: { level: 1, production: 2 }

        };

        

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

        function initGame() {

            tg.expand();

            tg.MainButton.setText("–ó–ê–ö–†–´–¢–¨");

            tg.MainButton.show();

            tg.MainButton.onClick(() => tg.close());

            

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

            loadUserData();

            

            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä

            setInterval(updateTimer, 1000);

            updateTimer();

            

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

            updateResourcesDisplay();

        }

        

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–≥–ª—É—à–∫–∞)

        function loadUserData() {

            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–æ—Ç–∞

            console.log("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...");

        }

        

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

        function updateResourcesDisplay() {

            document.getElementById('gems-count').textContent = resources.gems.toFixed(1);

            document.getElementById('food-count').textContent = resources.food;

            document.getElementById('wood-count').textContent = resources.wood;

            document.getElementById('stone-count').textContent = resources.stone;

        }

        

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞

        function updateTimer() {

            const now = Date.now();

            const timeLeft = COLLECTION_COOLDOWN - (now - lastCollectionTime);

            const timerElement = document.getElementById('timer');

            const timerStatus = document.getElementById('timerStatus');

            const collectBtn = document.getElementById('collectBtn');

            

            if (timeLeft <= 0) {

                // –ú–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å!

                timerElement.textContent = "00:00:00";

                timerStatus.innerHTML = "‚úÖ –†–µ—Å—É—Ä—Å—ã –≥–æ—Ç–æ–≤—ã –∫ —Å–±–æ—Ä—É!";

                timerStatus.className = "timer-status ready";

                collectBtn.disabled = false;

            } else {

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä

                const hours = Math.floor(timeLeft / (1000 * 60 * 60));

                const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));

                const seconds = Math.floor((timeLeft % (60000)) / 1000);

                

                timerElement.textContent = 

                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                

                timerStatus.innerHTML = `‚è≥ –î–æ —Å–±–æ—Ä–∞: <span id="timer">${timerElement.textContent}</span>`;

                timerStatus.className = "timer-status";

                collectBtn.disabled = true;

            }

        }

        

        // –°–±–æ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤

        function collectResources() {

            const now = Date.now();

            if (now - lastCollectionTime < COLLECTION_COOLDOWN) {

                tg.showAlert("‚ùå –ï—â–µ –Ω–µ –≤—Ä–µ–º—è –¥–ª—è —Å–±–æ—Ä–∞!");

                return;

            }

            

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É –Ω–∞ —Å–±–æ—Ä

            tg.sendData(JSON.stringify({

                action: 'collect_resources',

                user_id: tg.initDataUnsafe.user.id,

                timestamp: now

            }));

            

            // –í—Ä–µ–º–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

            resources.gems += buildings.castle.production * 12;

            resources.food += buildings.farm.production * 12;

            resources.wood += buildings.sawmill.production * 12;

            resources.stone += buildings.mine.production * 12;

            

            lastCollectionTime = now;

            updateResourcesDisplay();

            updateTimer();

            

            tg.showPopup({

                title: "üéÅ –†–µ—Å—É—Ä—Å—ã —Å–æ–±—Ä–∞–Ω—ã!",

                message: `–ó–∞ 12 —á–∞—Å–æ–≤ –ø–æ–ª—É—á–µ–Ω–æ:\n+${(buildings.castle.production * 12).toFixed(1)} üíé\n+${buildings.farm.production * 12} üåæ\n+${buildings.sawmill.production * 12} ü™µ\n+${buildings.mine.production * 12} ‚õ∞Ô∏è`,

                buttons: [{ type: "ok" }]

            });

        }

        

        // –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π

        function inviteFriends() {

            tg.showPopup({

                title: "üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π",

                message: "–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã!\n\n–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞: https://t.me/CastleOnTON_bot?start=ref_12345\n\n–ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ 1% –æ—Ç –µ–≥–æ –¥–æ–±—ã—á–∏!",

                buttons: [{ type: "ok" }]

            });

        }

        

        // –£–ª—É—á—à–µ–Ω–∏–µ –∑–¥–∞–Ω–∏–π

        function upgradeBuilding() {

            tg.showPopup({

                title: "‚ö° –£–ª—É—á—à–µ–Ω–∏–µ –∑–¥–∞–Ω–∏–π",

                message: "–í—ã–±–µ—Ä–∏—Ç–µ –∑–¥–∞–Ω–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:",

                buttons: [

                    { id: "upg_castle", type: "default", text: "üè∞ –ó–∞–º–æ–∫ (300 –∑–æ–ª–æ—Ç–∞)" },

                    { id: "upg_farm", type: "default", text: "üåæ –§–µ—Ä–º–∞ (150 –∑–æ–ª–æ—Ç–∞)" },

                    { id: "upg_sawmill", type: "default", text: "ü™µ –õ–µ—Å–æ–ø–∏–ª–∫–∞ (200 –∑–æ–ª–æ—Ç–∞)" },

                    { id: "upg_mine", type: "default", text: "‚õèÔ∏è –®–∞—Ö—Ç–∞ (250 –∑–æ–ª–æ—Ç–∞)" },

                    { type: "cancel" }

                ]

            });

        }

        

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

        function showStats() {

            tg.showPopup({

                title: "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞",

                message: `üëë –£—Ä–æ–≤–µ–Ω—å: 3\nüè∞ –ó–∞–º–æ–∫: –£—Ä. ${buildings.castle.level}\nüåæ –§–µ—Ä–º–∞: –£—Ä. ${buildings.farm.level}\nü™µ –õ–µ—Å–æ–ø–∏–ª–∫–∞: –£—Ä. ${buildings.sawmill.level}\n‚õèÔ∏è –®–∞—Ö—Ç–∞: Ur. ${buildings.mine.level}\n\n‚≠ê –û–±—â–∏–π –¥–æ—Ö–æ–¥: 21/—á–∞—Å`,

                buttons: [{ type: "ok" }]

            });

        }

        

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

        document.addEventListener('DOMContentLoaded', initGame);

    </script>

</body>

</html>
